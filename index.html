<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untuk Kita, Dunia, dan Kotornya</title>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:italic&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --nadin-brown: #7c6a46;
            --nadin-beige: #f9f6f0;
            --lily-pink: #fbcce7;
            --sun-yellow: #ffda62;
        }

        body, html {
            margin: 0; padding: 0; background: var(--nadin-beige);
            color: #4a453c; font-family: 'Inter', sans-serif;
            overflow-x: hidden; scroll-behavior: smooth;
        }

        .center-flex { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; text-align: center; }

        /* --- STAGE 1: BUNGA MENJALAR --- */
        #intro-stage { cursor: pointer; background: var(--nadin-beige); position: fixed; inset: 0; z-index: 200; }
        
        .vine-container { width: 300px; height: 400px; position: relative; }
        .vine { fill: none; stroke: #8fa17d; stroke-width: 3; stroke-dasharray: 1000; stroke-dashoffset: 1000; transition: stroke-dashoffset 6s ease-in-out; }
        .vine.grow { stroke-dashoffset: 0; }

        #lyric-text { font-family: 'Crimson Text', serif; font-size: 1.4rem; font-style: italic; margin-top: 20px; min-height: 40px; transition: 1s; }

        /* --- STAGE 2: AMPLOP & SURAT --- */
        #envelope-stage { display: none; padding: 100px 0; }
        .envelope-wrapper { position: relative; width: 320px; height: 200px; background: #f2ede4; box-shadow: 0 10px 40px rgba(0,0,0,0.1); margin: 0 auto; transition: 1s; }
        .envelope-top { position: absolute; top: 0; border-left: 160px solid transparent; border-right: 160px solid transparent; border-top: 120px solid #e2ddd3; transform-origin: top; transition: 1s; z-index: 10; }
        .envelope-wrapper.open .envelope-top { transform: rotateX(180deg); }
        
        .letter { position: absolute; bottom: 5px; left: 5px; right: 5px; background: white; height: 180px; transition: 2s; z-index: 5; overflow: hidden; padding: 20px; box-sizing: border-box; }
        .envelope-wrapper.open .letter { transform: translateY(-350px); height: 1200px; width: 360px; left: -20px; box-shadow: 0 5px 30px rgba(0,0,0,0.1); }

        /* Efek Bunga Keluar dari Amplop */
        .burst-flower { position: absolute; pointer-events: none; animation: fly 3s forwards; font-size: 20px; z-index: 15; }
        @keyframes fly { to { transform: translate(var(--x), var(--y)) rotate(360deg); opacity: 0; } }

        /* --- STAGE 3: BUNGA SPESIFIK (Lily & Sun) --- */
        .flower-choice { display: flex; gap: 40px; justify-content: center; margin: 40px 0; }
        .flower-btn { cursor: pointer; transition: 0.3s; filter: grayscale(50%); text-align: center; }
        .flower-btn:hover { filter: grayscale(0%); transform: scale(1.1); }
        .flower-icon { font-size: 50px; margin-bottom: 10px; }

        /* --- MODAL DETAIL --- */
        #detail-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 300; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .modal-content { background: var(--nadin-beige); padding: 40px; width: 85%; max-width: 400px; border-radius: 5px; position: relative; }
        .close-modal { position: absolute; top: 10px; right: 15px; cursor: pointer; font-size: 20px; }

        /* Slideshow */
        .slideshow { width: 100%; height: 250px; position: relative; overflow: hidden; margin: 20px 0; border: 1px solid #ddd; }
        .slideshow img { width: 100%; height: 100%; object-fit: cover; position: absolute; opacity: 0; transition: 1s; }
        .slideshow img.active { opacity: 1; }

        .hidden { display: none; opacity: 0; }
        button { background: var(--nadin-brown); color: white; border: none; padding: 12px 25px; cursor: pointer; font-family: 'Crimson Text'; font-style: italic; margin-top: 20px; }
    </style>
</head>
<body>

    <audio id="lagu" loop><source src="tapi diterima.mp3" type="audio/mpeg"></audio>

    <div id="intro-stage" class="center-flex">
        <div class="vine-container">
            <svg viewBox="0 0 100 200">
                <path id="main-vine" class="vine" d="M50,200 C50,150 20,150 20,100 C20,50 80,50 80,20" />
                <path class="vine" d="M50,150 C70,130 80,110 70,90" />
                <path class="vine" d="M30,120 C10,100 20,80 40,70" />
            </svg>
        </div>
        <p id="lyric-text">Klik untuk menumbuhkan cerita...</p>
    </div>

    <div id="envelope-stage" class="center-flex">
        <div class="envelope-wrapper" id="envelope">
            <div class="envelope-top"></div>
            <div class="letter" id="letter-content">
                <div id="inner-letter-content" class="hidden">
                    <p style="font-size: 0.7rem; letter-spacing: 2px;">SURAT TERBUKA</p>
                    <h2 style="font-family: 'Crimson Text'; font-weight: 400;">Untuk Kita, Dunia, dan Kotornya</h2>
                    <p style="font-family: 'Crimson Text'; font-style: italic;">"Mari saling membasuh luka sebelum musim baru tiba."</p>
                    
                    <div class="flower-choice">
                        <div class="flower-btn" onclick="openDetail('sarah')">
                            <div class="flower-icon">ðŸŒ¸</div>
                            <p>Lily (Sarah)</p>
                        </div>
                        <div class="flower-btn" onclick="openDetail('amal')">
                            <div class="flower-icon">ðŸŒ»</div>
                            <p>Matahari (Amal)</p>
                        </div>
                    </div>

                    <div id="closing-msg" style="margin-top: 50px; padding: 20px; border-top: 1px solid #eee;">
                        <p style="font-size: 0.9rem; line-height: 1.8;">
                            Semester 6 mungkin akan menagih segalanya, tapi selama kita saling menerima, kotornya dunia takkan mampu mematikan kita. <br><br>
                            <b>Mari tumbuh lebih baik.</b>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="detail-modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h3 id="modal-name" style="font-family: 'Crimson Text';"></h3>
            <div class="slideshow" id="modal-slideshow"></div>
            <p id="modal-text" style="font-size: 0.85rem; line-height: 1.6; text-align: justify;"></p>
        </div>
    </div>

    <script>
        const quotes = ["Sempurna tak ada padaku...", "Banyak kurangku...", "Tapi diterima.", "Mari kita tumbuh bersama lagi."];
        let started = false;

        function startIntro() {
            if(started) return;
            started = true;
            document.getElementById('lagu').play();
            
            // Animasi menjalar
            document.querySelectorAll('.vine').forEach(v => v.classList.add('grow'));
            
            let i = 0;
            const interval = setInterval(() => {
                const txt = document.getElementById('lyric-text');
                txt.style.opacity = 0;
                setTimeout(() => {
                    if(i < quotes.length) {
                        txt.innerText = quotes[i];
                        txt.style.opacity = 1;
                        i++;
                    } else {
                        clearInterval(interval);
                        setTimeout(transitionToEnvelope, 2000);
                    }
                }, 1000);
            }, 3000);
        }

        function transitionToEnvelope() {
            document.getElementById('intro-stage').style.opacity = 0;
            setTimeout(() => {
                document.getElementById('intro-stage').style.display = 'none';
                document.getElementById('envelope-stage').style.display = 'flex';
                setTimeout(openEnvelope, 1000);
            }, 2000);
        }

        function openEnvelope() {
            const env = document.getElementById('envelope');
            env.classList.add('open');
            
            // Bunga Beriringan keluar
            for(let j=0; j<25; j++) {
                setTimeout(() => createParticle(env), j * 100);
            }

            setTimeout(() => {
                document.getElementById('inner-letter-content').classList.remove('hidden');
                document.getElementById('inner-letter-content').style.opacity = 1;
                document.getElementById('inner-letter-content').style.transition = "2s";
            }, 2000);
        }

        function createParticle(parent) {
            const p = document.createElement('div');
            p.className = 'burst-flower';
            p.innerHTML = Math.random() > 0.5 ? 'ðŸŒ¸' : 'ðŸŒ»';
            p.style.setProperty('--x', `${(Math.random() - 0.5) * 400}px`);
            p.style.setProperty('--y', `${-Math.random() * 600}px`);
            p.style.left = '50%'; p.style.top = '20%';
            parent.appendChild(p);
            setTimeout(() => p.remove(), 3000);
        }

        const data = {
            sarah: {
                name: "Lily Merah Muda - Sarah",
                text: "Sarah, jika kemarin aku adalah duri yang tak sengaja melukai jemarimu, maafkan aku. Kita sudah berjalan sejauh ini. Di semester 6 nanti, saat dunia menagih seluruh sisa tenaga kita, aku tak ingin kita asing. Mari basuh debu yang lama, dan biarkan kita tumbuh lagi.",
                imgs: ["sarah 1.jpeg", "sarah 2.jpeg", "kita 1.jpeg"]
            },
            amal: {
                name: "Matahari Kuning - Amal",
                text: "Amal, banyak kurangku yang kau dekap dengan sabar, meski aku seringkali hanya memberi bau tanah. Semester depan akan menagih waktu yang kian sempit. Namun mari kita saling memaafkan. Agar di dunia yang kotor ini, kita tetap punya satu sama lain untuk pulang.",
                imgs: ["amal 1.jpeg", "amal 2.jpeg", "kita 2.jpeg"]
            }
        };

        function openDetail(person) {
            const modal = document.getElementById('detail-modal');
            const d = data[person];
            document.getElementById('modal-name').innerText = d.name;
            document.getElementById('modal-text').innerText = d.text;
            
            const slideContainer = document.getElementById('modal-slideshow');
            slideContainer.innerHTML = '';
            d.imgs.forEach((img, idx) => {
                const el = document.createElement('img');
                el.src = img;
                if(idx === 0) el.className = 'active';
                slideContainer.appendChild(el);
            });

            modal.style.display = 'flex';
            startModalSlideshow();
        }

        function closeModal() {
            document.getElementById('detail-modal').style.display = 'none';
            clearInterval(window.modalInterval);
        }

        function startModalSlideshow() {
            clearInterval(window.modalInterval);
            window.modalInterval = setInterval(() => {
                const imgs = document.querySelectorAll('#modal-slideshow img');
                let activeIdx = 0;
                imgs.forEach((img, idx) => {
                    if(img.classList.contains('active')) activeIdx = idx;
                    img.classList.remove('active');
                });
                imgs[(activeIdx + 1) % imgs.length].classList.add('active');
            }, 2500);
        }

        document.getElementById('intro-stage').onclick = startIntro;
    </script>
</body>
</html>