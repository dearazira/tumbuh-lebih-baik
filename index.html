<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Untuk Kita, Dunia, dan Kotornya</title>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:italic&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --nadin-brown: #7c6a46;
            --nadin-beige: #f9f6f0;
            --petal-color: #e5d1b8;
            --envelope-color: #f2ede4;
        }

        body, html {
            margin: 0; padding: 0;
            background-color: var(--nadin-beige);
            font-family: 'Inter', sans-serif;
            color: #5b574a;
            overflow-x: hidden;
            display: flex; justify-content: center; align-items: center; min-height: 100vh;
        }

        /* --- STAGE 1: INTRO BUNGA INTERAKTIF --- */
        #intro-stage {
            position: fixed; inset: 0;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 100; background: var(--nadin-beige);
            transition: opacity 2s;
        }

        .flower-grow { position: relative; width: 100px; height: 200px; cursor: pointer; }
        .stem { 
            width: 3px; background: #8fa17d; position: absolute; bottom: 0; left: 50%; 
            height: 0; transition: height 4s ease-in-out; 
        }
        .blossom { 
            position: absolute; top: 0; left: 50%; transform: translate(-50%, -50%) scale(0);
            transition: transform 2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .petal-intro {
            position: absolute; background: var(--petal-color); width: 40px; height: 60px;
            border-radius: 50% 50% 50% 50% / 80% 80% 20% 20%; transform-origin: bottom center;
            border: 1px solid rgba(0,0,0,0.05);
        }

        #lyric-display { font-family: 'Crimson Text', serif; font-size: 1.5rem; font-style: italic; margin-top: 40px; height: 30px; opacity: 0; transition: opacity 1s; }

        /* --- STAGE 2: AMPLOP & SURAT --- */
        #envelope-stage { display: none; perspective: 1000px; padding-top: 100px; }
        
        .envelope-wrapper { position: relative; width: 320px; height: 200px; background: var(--envelope-color); margin: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .envelope-top {
            position: absolute; top: 0; width: 0; height: 0;
            border-left: 160px solid transparent; border-right: 160px solid transparent;
            border-top: 120px solid #e2ddd3; transform-origin: top; z-index: 5; transition: transform 1s;
        }
        .envelope-wrapper.open .envelope-top { transform: rotateX(180deg); z-index: 1; }

        .letter {
            position: absolute; bottom: 10px; left: 10px; right: 10px; background: white;
            padding: 20px; height: 160px; transition: transform 2s, height 2s;
            z-index: 2; overflow: hidden; border: 1px solid #eee;
        }
        .envelope-wrapper.open .letter { transform: translateY(-300px); height: 1100px; width: 350px; left: -15px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); }

        /* --- STAGE 3: CONTENT INSIDE LETTER --- */
        .main-content { opacity: 0; transition: opacity 2s 1s; padding: 20px; text-align: center; }
        .card { background: var(--nadin-beige); padding: 20px; margin-top: 30px; border: 1px solid #ece9e0; }
        .slideshow { width: 100%; height: 200px; overflow: hidden; position: relative; margin-bottom: 15px; }
        .slideshow img { width: 100%; height: 100%; object-fit: cover; position: absolute; opacity: 0; transition: opacity 1s; }
        .slideshow img.active { opacity: 1; }

        /* --- FLOWER BURST PARTICLES --- */
        .burst-flower {
            position: absolute; width: 15px; height: 15px; background: var(--petal-color);
            border-radius: 50%; pointer-events: none; z-index: 10; animation: fly 3s forwards ease-out;
        }
        @keyframes fly {
            to { transform: translate(var(--x), var(--y)) rotate(360deg); opacity: 0; }
        }

        button { background: var(--nadin-brown); color: white; border: none; padding: 10px 20px; cursor: pointer; font-family: 'Crimson Text', serif; font-style: italic; margin-top: 20px; }
    </style>
</head>
<body>

    <audio id="lagu" loop><source src="tapi diterima.mp3" type="audio/mpeg"></audio>

    <div id="intro-stage">
        <div class="flower-grow" onclick="startExperience()">
            <div class="stem" id="intro-stem"></div>
            <div class="blossom" id="intro-blossom">
                <div class="petal-intro" style="transform: rotate(0deg)"></div>
                <div class="petal-intro" style="transform: rotate(72deg)"></div>
                <div class="petal-intro" style="transform: rotate(144deg)"></div>
                <div class="petal-intro" style="transform: rotate(216deg)"></div>
                <div class="petal-intro" style="transform: rotate(288deg)"></div>
            </div>
        </div>
        <p id="lyric-display">Klik bunga untuk mulai tumbuh...</p>
    </div>

    <div id="envelope-stage">
        <div class="envelope-wrapper" id="envelope">
            <div class="envelope-top"></div>
            <div class="letter">
                <div class="main-content" id="final-content">
                    <p style="letter-spacing: 2px; font-size: 0.7rem;">REKONSILIASI</p>
                    <h2 style="font-family: 'Crimson Text'; font-weight: 400; color: var(--nadin-brown);">Untuk Kita, Dunia, dan Kotornya</h2>
                    
                    <div class="card">
                        <div class="slideshow" id="slide-sarah">
                            <img src="sarah 1.jpeg" class="active">
                            <img src="sarah 2.jpeg">
                            <img src="kita 1.jpeg">
                        </div>
                        <h4 style="font-family: 'Crimson Text';">Untuk Sarah</h4>
                        <p style="font-size: 0.8rem; line-height: 1.6;">"Jika kemarin aku adalah duri yang tak sengaja melukai jemarimu, maafkan aku. Mari basuh debu yang lama, dan biarkan kita tumbuh lagi."</p>
                    </div>

                    <div class="card">
                        <div class="slideshow" id="slide-amal">
                            <img src="amal 1.jpeg" class="active">
                            <img src="amal 2.jpeg">
                            <img src="kita 2.jpeg">
                        </div>
                        <h4 style="font-family: 'Crimson Text';">Untuk Amal</h4>
                        <p style="font-size: 0.8rem; line-height: 1.6;">"Banyak kurangku yang kau dekap dengan sabar. Mari saling memaafkan agar kita tetap punya satu sama lain untuk pulang."</p>
                    </div>

                    <button onclick="location.reload()">Mulai Lagi dari Awal?</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const quotes = ["Sempurna tak ada padaku...", "Atas harumnya kasihmu...", "Segala kurangku...", "Tapi diterima."];
        let hasStarted = false;

        function startExperience() {
            if(hasStarted) return;
            hasStarted = true;
            document.getElementById('lagu').play();
            
            // 1. Tumbuhkan batang
            document.getElementById('intro-stem').style.height = '150px';
            
            // 2. Jalankan lirik
            let i = 0;
            const lyricInterval = setInterval(() => {
                const el = document.getElementById('lyric-display');
                el.style.opacity = 0;
                setTimeout(() => {
                    if(i < quotes.length) {
                        el.innerText = quotes[i];
                        el.style.opacity = 1;
                        if(i === 3) document.getElementById('intro-blossom').style.transform = 'translate(-50%, -50%) scale(1.5)';
                        i++;
                    } else {
                        clearInterval(lyricInterval);
                        setTimeout(transitionToEnvelope, 2000);
                    }
                }, 1000);
            }, 3500);
        }

        function transitionToEnvelope() {
            document.getElementById('intro-stage').style.opacity = 0;
            setTimeout(() => {
                document.getElementById('intro-stage').style.display = 'none';
                document.getElementById('envelope-stage').style.display = 'block';
                setTimeout(openEnvelope, 1500);
            }, 2000);
        }

        function openEnvelope() {
            const env = document.getElementById('envelope');
            env.classList.add('open');
            
            // Burst bunga saat terbuka
            for(let i=0; i<30; i++) {
                createFlowerBurst(env);
            }

            setTimeout(() => {
                document.getElementById('final-content').style.opacity = 1;
                startSlideshows();
            }, 2000);
        }

        function createFlowerBurst(parent) {
            const f = document.createElement('div');
            f.className = 'burst-flower';
            const x = (Math.random() - 0.5) * 500;
            const y = (Math.random() - 0.8) * 500;
            f.style.setProperty('--x', `${x}px`);
            f.style.setProperty('--y', `${y}px`);
            f.style.left = '50%';
            f.style.top = '20%';
            parent.appendChild(f);
            setTimeout(() => f.remove(), 3000);
        }

        function startSlideshows() {
            setInterval(() => { rotate('slide-sarah'); rotate('slide-amal'); }, 3000);
        }

        function rotate(id) {
            const imgs = document.getElementById(id).getElementsByTagName('img');
            let activeIdx = 0;
            for(let j=0; j<imgs.length; j++) {
                if(imgs[j].classList.contains('active')) {
                    activeIdx = j;
                    imgs[j].classList.remove('active');
                    break;
                }
            }
            imgs[(activeIdx + 1) % imgs.length].classList.add('active');
        }
    </script>
</body>
</html>